<div class="space-y-4">
  <div>
    <select
      [value]="selectedCategoryId"
      (change)="onCategoryChange($any($event.target).value)"
      class="w-full px-4 py-3 border border-neutral-200 rounded-xl focus:ring-2 focus:ring-secondary-500 focus:border-secondary-500 transition-colors duration-200 font-sans bg-white"
      [class.border-error-300]="required && selectedCategoryId === 0"
    >
      <option value="0">{{ placeholder }}</option>
      @for (category of categories; track category.id) {
        <option [value]="category.id">{{ category.name }}</option>
      }
      <option value="-1">+ Create new category</option>
    </select>
  </div>

  @if (showCustomCategoryInput()) {
    <div class="bg-secondary-50 border border-secondary-200 rounded-xl p-4 animate-slide-down">
      <div class="space-y-3">
        <div>
          <label class="block text-sm font-medium text-neutral-700 mb-2 font-sans">
            New Category Name <span class="text-error-500">*</span>
          </label>
          <input
            type="text"
            [(ngModel)]="customCategoryName"
            placeholder="Enter category name"
            class="w-full px-4 py-3 border border-neutral-200 rounded-xl focus:ring-2 focus:ring-secondary-500 focus:border-secondary-500 transition-colors duration-200 font-sans"
          />
        </div>
        <div class="flex space-x-3">
          <button
            type="button"
            (click)="onCreateCategory()"
            [disabled]="!customCategoryName().trim()"
            class="flex-1 inline-flex items-center justify-center px-4 py-2 bg-success-500 hover:bg-success-600 disabled:bg-success-300 text-white font-medium rounded-lg transition-colors duration-200 font-heading"
          >
            <svg class="h-4 w-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M12 6v6m0 0v6m0-6h6m-6 0H6"
              />
            </svg>
            Create
          </button>
          <button
            type="button"
            (click)="resetCustomInput(); onCategoryChange('0')"
            class="px-4 py-2 bg-neutral-200 hover:bg-neutral-300 text-neutral-700 font-medium rounded-lg transition-colors duration-200 font-heading"
          >
            Cancel
          </button>
        </div>
      </div>
    </div>
  }
</div>